<form class="feedback-form" [formGroup]="form" (ngSubmit)="submit()" novalidate>
	<div class="message info" *ngIf="!auth.isAuthenticated()">
		<mat-icon aria-hidden="true">info</mat-icon>
		<span>You need to be signed in to share your experience.</span>
	</div>

	<div class="message success" *ngIf="successMessage() as message">
		<mat-icon aria-hidden="true">check_circle</mat-icon>
		<span>{{ message }}</span>
	</div>

	<div class="message error" *ngIf="errorMessage() as message">
		<mat-icon aria-hidden="true">error</mat-icon>
		<span>{{ message }}</span>
	</div>

	<mat-form-field appearance="fill" class="full-width">
		<mat-label>Rating</mat-label>
			<mat-select formControlName="rating" [disabled]="!auth.isAuthenticated() || submitting()" required>
			<mat-option *ngFor="let value of ratings" [value]="value">
				<span class="rating-option">
							<mat-icon aria-hidden="true" *ngFor="let _ of starArray(value)">star</mat-icon>
						<span>{{ value }}</span>
				</span>
			</mat-option>
		</mat-select>
		<mat-error *ngIf="form.controls.rating.hasError('required')">Choose a rating between 0 and 5.</mat-error>
	</mat-form-field>

	<mat-form-field appearance="fill" class="full-width">
		<mat-label>Comments (optional)</mat-label>
		<textarea
			matInput
			formControlName="comment"
			[disabled]="!auth.isAuthenticated() || submitting()"
			rows="5"
			maxlength="5000"
			placeholder="What stood out during your ride?"
		></textarea>
		<mat-hint align="end">{{ form.controls.comment.value?.length || 0 }}/5000</mat-hint>
	</mat-form-field>

	<div class="actions">
			<button
				mat-flat-button
				color="primary"
				type="submit"
				[disabled]="!auth.isAuthenticated() || submitting() || form.invalid"
			>
			<mat-icon aria-hidden="true" *ngIf="submitting()" class="spin">hourglass_top</mat-icon>
			<span>{{ submitting() ? 'Submittingâ€¦' : 'Submit feedback' }}</span>
		</button>
	</div>
</form>
