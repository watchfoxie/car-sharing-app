# Test configuration for Feedback Service
spring:
  application:
    name: feedback-service-test
  
  # Testcontainers PostgreSQL
  datasource:
    url: jdbc:tc:postgresql:16-alpine:///testdb?TC_INITSCRIPT=schema-init.sql
    driver-class-name: org.testcontainers.jdbc.ContainerDatabaseDriver
  
  jpa:
    hibernate:
      ddl-auto: create-drop
    properties:
      hibernate:
        dialect: org.hibernate.dialect.PostgreSQLDialect
        '[default_schema]': feedback
        '[format_sql]': true
        '[hbm2ddl.import_files]': trigger-setup.sql
    show-sql: true
  
  # Flyway migration
  flyway:
    enabled: false
    schemas: feedback
    baseline-on-migrate: true
    locations: classpath:db/migration
  
  # Mock OAuth2 Resource Server
  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: http://localhost:9999/realms/test
  
  # Disable Cloud Config
  cloud:
    config:
      enabled: false
  
  # Kafka (not needed for tests)
  kafka:
    bootstrap-servers: ${KAFKA_BOOTSTRAP_SERVERS:localhost:9092}

# Disable Eureka for tests
eureka:
  client:
    enabled: false

# Actuator (minimal exposure for tests)
management:
  endpoints:
    web:
      exposure:
        include: health

# SpringDoc (disabled for tests)
springdoc:
  api-docs:
    enabled: false
  swagger-ui:
    enabled: false

# Debug logging for tests
logging:
  level:
    root: INFO
    '[com.services.feedback_service]': DEBUG
    '[org.springframework.jdbc]': DEBUG
    '[org.hibernate.SQL]': DEBUG
    '[org.hibernate.type.descriptor.sql.BasicBinder]': TRACE
    '[org.testcontainers]': INFO
