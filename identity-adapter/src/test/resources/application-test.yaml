# Test profile configuration for Identity Adapter Service
spring:
  application:
    name: identity-adapter-test
  
  # Datasource - managed by Testcontainers @ServiceConnection
  datasource:
    driver-class-name: org.postgresql.Driver
  
  # JPA configuration
  jpa:
    hibernate:
      ddl-auto: validate  # Flyway handles schema, Hibernate validates
    show-sql: true
    properties:
      hibernate:
        '[format_sql]': true
        '[default_schema]': identity
        dialect: org.hibernate.dialect.PostgreSQLDialect
        jdbc:
          '[time_zone]': UTC
  
  # Flyway
  flyway:
    enabled: true
    baseline-on-migrate: true
    schemas: identity
    locations: classpath:db/migration
  
  # Security - OAuth2 disabled for tests (use @WithMockUser instead)
  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: http://localhost:8180/realms/car-sharing  # Mock issuer for tests
  
  # Eureka - disabled for unit tests
  cloud:
    discovery:
      enabled: false
    config:
      enabled: false

# Eureka - disabled
eureka:
  client:
    enabled: false

# Actuator
management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: always

# Logging
logging:
  level:
    '[com.services.identity_adapter]': DEBUG
    '[org.springframework.security]': DEBUG
    '[org.hibernate.SQL]': DEBUG
    '[org.hibernate.type.descriptor.sql.BasicBinder]': TRACE
